Sentinel File
  PsiComment(SentinelTokenType.COMMENT)('#https://github.com/hashicorp/terraform-guides/blob/master/governance/second-generation/aws/enforce-mandatory-tags.sentinel')
  PsiWhiteSpace('\n')
  PsiComment(SentinelTokenType.COMMENT)('# This policy uses the Sentinel tfplan import to require that all EC2 instances')
  PsiWhiteSpace('\n')
  PsiComment(SentinelTokenType.COMMENT)('# have all mandatory tags.')
  PsiWhiteSpace('\n\n')
  PsiComment(SentinelTokenType.COMMENT)('# Note that the comparison is case-sensitive since AWS tags are case-sensitive.')
  PsiWhiteSpace('\n\n')
  PsiComment(SentinelTokenType.COMMENT)('##### Imports #####')
  PsiWhiteSpace('\n\n')
  SentinelDefinitionImpl(DEFINITION)
    SentinelImportStatementImpl(IMPORT_STATEMENT)
      PsiElement(SentinelTokenType.import)('import')
      PsiWhiteSpace(' ')
      SentinelStringLiteralImpl(STRING_LITERAL)
        PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"tfplan"')
  PsiWhiteSpace('\n')
  SentinelDefinitionImpl(DEFINITION)
    SentinelImportStatementImpl(IMPORT_STATEMENT)
      PsiElement(SentinelTokenType.import)('import')
      PsiWhiteSpace(' ')
      SentinelStringLiteralImpl(STRING_LITERAL)
        PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"strings"')
  PsiWhiteSpace('\n')
  SentinelDefinitionImpl(DEFINITION)
    SentinelImportStatementImpl(IMPORT_STATEMENT)
      PsiElement(SentinelTokenType.import)('import')
      PsiWhiteSpace(' ')
      SentinelStringLiteralImpl(STRING_LITERAL)
        PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"types"')
  PsiWhiteSpace('\n\n')
  PsiComment(SentinelTokenType.COMMENT)('##### Functions #####')
  PsiWhiteSpace('\n\n')
  PsiComment(SentinelTokenType.COMMENT)('# Find all resources of a specific type from all modules using the tfplan import')
  PsiWhiteSpace('\n')
  SentinelDefinitionImpl(DEFINITION)
    SentinelFunctionDeclarationImpl(FUNCTION_DECLARATION)
      PsiElement(SentinelTokenType.IDENTIFIER)('find_resources_from_plan')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.=)('=')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.func)('func')
      SentinelFunctionImpl(FUNCTION)
        SentinelFunctionParametersImpl(FUNCTION_PARAMETERS)
          PsiElement(SentinelTokenType.()('(')
          PsiElement(SentinelTokenType.IDENTIFIER)('type')
          PsiElement(SentinelTokenType.))(')')
        PsiWhiteSpace(' ')
        SentinelFunctionBodyImpl(FUNCTION_BODY)
          PsiElement(SentinelTokenType.{)('{')
          PsiWhiteSpace('\n\n  ')
          SentinelFunctionStatementImpl(FUNCTION_STATEMENT)
            SentinelVariableDefinitionImpl(VARIABLE_DEFINITION)
              SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                PsiElement(SentinelTokenType.IDENTIFIER)('resources')
              PsiWhiteSpace(' ')
              PsiElement(SentinelTokenType.=)('=')
              PsiWhiteSpace(' ')
              SentinelMapDefinitionImpl(MAP_DEFINITION)
                PsiElement(SentinelTokenType.{)('{')
                PsiElement(SentinelTokenType.})('}')
          PsiWhiteSpace('\n\n  ')
          PsiComment(SentinelTokenType.COMMENT)('# Iterate over all modules in the tfplan import')
          PsiWhiteSpace('\n  ')
          SentinelFunctionStatementImpl(FUNCTION_STATEMENT)
            SentinelForStatementImpl(FOR_STATEMENT)
              PsiElement(SentinelTokenType.for)('for')
              PsiWhiteSpace(' ')
              SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                PsiElement(SentinelTokenType.IDENTIFIER)('tfplan')
                SentinelSelectorImpl(SELECTOR)
                  PsiElement(SentinelTokenType..)('.')
                  PsiElement(SentinelTokenType.IDENTIFIER)('module_paths')
              PsiWhiteSpace(' ')
              PsiElement(SentinelTokenType.as)('as')
              PsiWhiteSpace(' ')
              PsiElement(SentinelTokenType.IDENTIFIER)('path')
              PsiWhiteSpace(' ')
              SentinelForBlockImpl(FOR_BLOCK)
                PsiElement(SentinelTokenType.{)('{')
                PsiWhiteSpace('\n    ')
                PsiComment(SentinelTokenType.COMMENT)('# Iterate over the named resources of desired type in the module')
                PsiWhiteSpace('\n    ')
                SentinelStatementImpl(STATEMENT)
                  SentinelForStatementImpl(FOR_STATEMENT)
                    PsiElement(SentinelTokenType.for)('for')
                    PsiWhiteSpace(' ')
                    SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                      PsiElement(SentinelTokenType.IDENTIFIER)('tfplan')
                      SentinelSelectorImpl(SELECTOR)
                        PsiElement(SentinelTokenType..)('.')
                        PsiElement(SentinelTokenType.IDENTIFIER)('module')
                      PsiElement(SentinelTokenType.()('(')
                      PsiElement(SentinelTokenType.IDENTIFIER)('path')
                      PsiElement(SentinelTokenType.))(')')
                      SentinelSelectorImpl(SELECTOR)
                        PsiElement(SentinelTokenType..)('.')
                        PsiElement(SentinelTokenType.IDENTIFIER)('resources')
                      PsiElement(SentinelTokenType.[)('[')
                      PsiElement(SentinelTokenType.IDENTIFIER)('type')
                      PsiElement(SentinelTokenType.])(']')
                      PsiWhiteSpace(' ')
                      SentinelElseOperatorImpl(ELSE_OPERATOR)
                        SentinelElseClauseImpl(ELSE_CLAUSE)
                          PsiElement(SentinelTokenType.else)('else')
                        PsiWhiteSpace(' ')
                        SentinelMapDefinitionImpl(MAP_DEFINITION)
                          PsiElement(SentinelTokenType.{)('{')
                          PsiElement(SentinelTokenType.})('}')
                    PsiWhiteSpace(' ')
                    PsiElement(SentinelTokenType.as)('as')
                    PsiWhiteSpace(' ')
                    PsiElement(SentinelTokenType.IDENTIFIER)('name')
                    PsiElement(SentinelTokenType.,)(',')
                    PsiWhiteSpace(' ')
                    PsiElement(SentinelTokenType.IDENTIFIER)('instances')
                    PsiWhiteSpace(' ')
                    SentinelForBlockImpl(FOR_BLOCK)
                      PsiElement(SentinelTokenType.{)('{')
                      PsiWhiteSpace('\n      ')
                      PsiComment(SentinelTokenType.COMMENT)('# Iterate over resource instances')
                      PsiWhiteSpace('\n      ')
                      SentinelStatementImpl(STATEMENT)
                        SentinelForStatementImpl(FOR_STATEMENT)
                          PsiElement(SentinelTokenType.for)('for')
                          PsiWhiteSpace(' ')
                          SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                            PsiElement(SentinelTokenType.IDENTIFIER)('instances')
                          PsiWhiteSpace(' ')
                          PsiElement(SentinelTokenType.as)('as')
                          PsiWhiteSpace(' ')
                          PsiElement(SentinelTokenType.IDENTIFIER)('index')
                          PsiElement(SentinelTokenType.,)(',')
                          PsiWhiteSpace(' ')
                          PsiElement(SentinelTokenType.IDENTIFIER)('r')
                          PsiWhiteSpace(' ')
                          SentinelForBlockImpl(FOR_BLOCK)
                            PsiElement(SentinelTokenType.{)('{')
                            PsiWhiteSpace('\n\n        ')
                            PsiComment(SentinelTokenType.COMMENT)('# Get the address of the instance')
                            PsiWhiteSpace('\n        ')
                            SentinelStatementImpl(STATEMENT)
                              SentinelIfStatementImpl(IF_STATEMENT)
                                PsiElement(SentinelTokenType.if)('if')
                                PsiWhiteSpace(' ')
                                SentinelBooleanExpressionsImpl(BOOLEAN_EXPRESSIONS)
                                  SentinelBooleanExpressionImpl(BOOLEAN_EXPRESSION)
                                    SentinelBooleanExpressionSegmentImpl(BOOLEAN_EXPRESSION_SEGMENT)
                                      SentinelFunctionCallImpl(FUNCTION_CALL)
                                        PsiElement(SentinelTokenType.IDENTIFIER)('length')
                                        SentinelFunctionCallParametersImpl(FUNCTION_CALL_PARAMETERS)
                                          PsiElement(SentinelTokenType.()('(')
                                          SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                                            PsiElement(SentinelTokenType.IDENTIFIER)('path')
                                          PsiElement(SentinelTokenType.))(')')
                                    PsiWhiteSpace(' ')
                                    SentinelBooleanOperatorsImpl(BOOLEAN_OPERATORS)
                                      SentinelComparisonOperatorImpl(COMPARISON_OPERATOR)
                                        PsiElement(SentinelTokenType.==)('==')
                                    PsiWhiteSpace(' ')
                                    SentinelBooleanExpressionSegmentImpl(BOOLEAN_EXPRESSION_SEGMENT)
                                      SentinelLiteralImpl(LITERAL)
                                        PsiElement(SentinelTokenType.NUMBER)('0')
                                PsiWhiteSpace(' ')
                                SentinelBlockImpl(BLOCK)
                                  PsiElement(SentinelTokenType.{)('{')
                                  PsiWhiteSpace('\n          ')
                                  PsiComment(SentinelTokenType.COMMENT)('# root module')
                                  PsiWhiteSpace('\n          ')
                                  SentinelStatementImpl(STATEMENT)
                                    SentinelVariableDefinitionImpl(VARIABLE_DEFINITION)
                                      SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                                        PsiElement(SentinelTokenType.IDENTIFIER)('address')
                                      PsiWhiteSpace(' ')
                                      PsiElement(SentinelTokenType.=)('=')
                                      PsiWhiteSpace(' ')
                                      SentinelBooleanExpressionsImpl(BOOLEAN_EXPRESSIONS)
                                        SentinelBooleanExpressionImpl(BOOLEAN_EXPRESSION)
                                          SentinelBooleanExpressionSegmentImpl(BOOLEAN_EXPRESSION_SEGMENT)
                                            SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                                              PsiElement(SentinelTokenType.IDENTIFIER)('type')
                                          PsiWhiteSpace(' ')
                                          SentinelBooleanOperatorsImpl(BOOLEAN_OPERATORS)
                                            SentinelUnaryOperatorImpl(UNARY_OPERATOR)
                                              PsiElement(SentinelTokenType.+)('+')
                                          PsiWhiteSpace(' ')
                                          SentinelBooleanExpressionSegmentImpl(BOOLEAN_EXPRESSION_SEGMENT)
                                            SentinelLiteralImpl(LITERAL)
                                              SentinelStringLiteralImpl(STRING_LITERAL)
                                                PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"."')
                                        PsiWhiteSpace(' ')
                                        SentinelBooleanExpressionImpl(BOOLEAN_EXPRESSION)
                                          SentinelUnaryOperatorImpl(UNARY_OPERATOR)
                                            PsiElement(SentinelTokenType.+)('+')
                                          PsiWhiteSpace(' ')
                                          SentinelBooleanExpressionSegmentImpl(BOOLEAN_EXPRESSION_SEGMENT)
                                            SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                                              PsiElement(SentinelTokenType.IDENTIFIER)('name')
                                          PsiWhiteSpace(' ')
                                          SentinelBooleanOperatorsImpl(BOOLEAN_OPERATORS)
                                            SentinelUnaryOperatorImpl(UNARY_OPERATOR)
                                              PsiElement(SentinelTokenType.+)('+')
                                          PsiWhiteSpace(' ')
                                          SentinelBooleanExpressionSegmentImpl(BOOLEAN_EXPRESSION_SEGMENT)
                                            SentinelLiteralImpl(LITERAL)
                                              SentinelStringLiteralImpl(STRING_LITERAL)
                                                PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"["')
                                        PsiWhiteSpace(' ')
                                        SentinelBooleanExpressionImpl(BOOLEAN_EXPRESSION)
                                          SentinelUnaryOperatorImpl(UNARY_OPERATOR)
                                            PsiElement(SentinelTokenType.+)('+')
                                          PsiWhiteSpace(' ')
                                          SentinelBooleanExpressionSegmentImpl(BOOLEAN_EXPRESSION_SEGMENT)
                                            SentinelFunctionCallImpl(FUNCTION_CALL)
                                              PsiElement(SentinelTokenType.IDENTIFIER)('string')
                                              SentinelFunctionCallParametersImpl(FUNCTION_CALL_PARAMETERS)
                                                PsiElement(SentinelTokenType.()('(')
                                                SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                                                  PsiElement(SentinelTokenType.IDENTIFIER)('index')
                                                PsiElement(SentinelTokenType.))(')')
                                          PsiWhiteSpace(' ')
                                          SentinelBooleanOperatorsImpl(BOOLEAN_OPERATORS)
                                            SentinelUnaryOperatorImpl(UNARY_OPERATOR)
                                              PsiElement(SentinelTokenType.+)('+')
                                          PsiWhiteSpace(' ')
                                          SentinelBooleanExpressionSegmentImpl(BOOLEAN_EXPRESSION_SEGMENT)
                                            SentinelLiteralImpl(LITERAL)
                                              SentinelStringLiteralImpl(STRING_LITERAL)
                                                PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"]"')
                                  PsiWhiteSpace('\n        ')
                                  PsiElement(SentinelTokenType.})('}')
                                PsiWhiteSpace(' ')
                                PsiElement(SentinelTokenType.else)('else')
                                PsiWhiteSpace(' ')
                                SentinelBlockImpl(BLOCK)
                                  PsiElement(SentinelTokenType.{)('{')
                                  PsiWhiteSpace('\n          ')
                                  PsiComment(SentinelTokenType.COMMENT)('# non-root module')
                                  PsiWhiteSpace('\n          ')
                                  SentinelStatementImpl(STATEMENT)
                                    SentinelVariableDefinitionImpl(VARIABLE_DEFINITION)
                                      SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                                        PsiElement(SentinelTokenType.IDENTIFIER)('address')
                                      PsiWhiteSpace(' ')
                                      PsiElement(SentinelTokenType.=)('=')
                                      PsiWhiteSpace(' ')
                                      SentinelLiteralImpl(LITERAL)
                                        SentinelStringLiteralImpl(STRING_LITERAL)
                                          PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"module."')
                                      PsiWhiteSpace(' ')
                                      SentinelVariableConcatenationImpl(VARIABLE_CONCATENATION)
                                        PsiElement(SentinelTokenType.+)('+')
                                        PsiWhiteSpace(' ')
                                        SentinelChainedIdentifierFunctionCallImpl(CHAINED_IDENTIFIER_FUNCTION_CALL)
                                          SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                                            PsiElement(SentinelTokenType.IDENTIFIER)('strings')
                                            SentinelSelectorImpl(SELECTOR)
                                              PsiElement(SentinelTokenType..)('.')
                                              PsiElement(SentinelTokenType.IDENTIFIER)('join')
                                          SentinelFunctionCallParametersImpl(FUNCTION_CALL_PARAMETERS)
                                            PsiElement(SentinelTokenType.()('(')
                                            SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                                              PsiElement(SentinelTokenType.IDENTIFIER)('path')
                                            PsiElement(SentinelTokenType.,)(',')
                                            PsiWhiteSpace(' ')
                                            SentinelLiteralImpl(LITERAL)
                                              SentinelStringLiteralImpl(STRING_LITERAL)
                                                PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('".module."')
                                            PsiElement(SentinelTokenType.))(')')
                                      PsiWhiteSpace(' ')
                                      SentinelVariableConcatenationImpl(VARIABLE_CONCATENATION)
                                        PsiElement(SentinelTokenType.+)('+')
                                        PsiWhiteSpace(' ')
                                        SentinelLiteralImpl(LITERAL)
                                          SentinelStringLiteralImpl(STRING_LITERAL)
                                            PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"."')
                                      PsiWhiteSpace(' ')
                                      SentinelVariableConcatenationImpl(VARIABLE_CONCATENATION)
                                        PsiElement(SentinelTokenType.+)('+')
                                        PsiWhiteSpace('\n                    ')
                                        SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                                          PsiElement(SentinelTokenType.IDENTIFIER)('type')
                                      PsiWhiteSpace(' ')
                                      SentinelVariableConcatenationImpl(VARIABLE_CONCATENATION)
                                        PsiElement(SentinelTokenType.+)('+')
                                        PsiWhiteSpace(' ')
                                        SentinelLiteralImpl(LITERAL)
                                          SentinelStringLiteralImpl(STRING_LITERAL)
                                            PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"."')
                                      PsiWhiteSpace(' ')
                                      SentinelVariableConcatenationImpl(VARIABLE_CONCATENATION)
                                        PsiElement(SentinelTokenType.+)('+')
                                        PsiWhiteSpace(' ')
                                        SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                                          PsiElement(SentinelTokenType.IDENTIFIER)('name')
                                      PsiWhiteSpace(' ')
                                      SentinelVariableConcatenationImpl(VARIABLE_CONCATENATION)
                                        PsiElement(SentinelTokenType.+)('+')
                                        PsiWhiteSpace(' ')
                                        SentinelLiteralImpl(LITERAL)
                                          SentinelStringLiteralImpl(STRING_LITERAL)
                                            PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"["')
                                      PsiWhiteSpace(' ')
                                      SentinelVariableConcatenationImpl(VARIABLE_CONCATENATION)
                                        PsiElement(SentinelTokenType.+)('+')
                                        PsiWhiteSpace(' ')
                                        SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                                          PsiElement(SentinelTokenType.IDENTIFIER)('string')
                                          PsiElement(SentinelTokenType.()('(')
                                          PsiElement(SentinelTokenType.IDENTIFIER)('index')
                                          PsiElement(SentinelTokenType.))(')')
                                      PsiWhiteSpace(' ')
                                      SentinelVariableConcatenationImpl(VARIABLE_CONCATENATION)
                                        PsiElement(SentinelTokenType.+)('+')
                                        PsiWhiteSpace(' ')
                                        SentinelLiteralImpl(LITERAL)
                                          SentinelStringLiteralImpl(STRING_LITERAL)
                                            PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"]"')
                                  PsiWhiteSpace('\n        ')
                                  PsiElement(SentinelTokenType.})('}')
                            PsiWhiteSpace('\n\n        ')
                            PsiComment(SentinelTokenType.COMMENT)('# Add the instance to resources map, setting the key to the address')
                            PsiWhiteSpace('\n        ')
                            SentinelStatementImpl(STATEMENT)
                              SentinelVariableDefinitionImpl(VARIABLE_DEFINITION)
                                SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                                  PsiElement(SentinelTokenType.IDENTIFIER)('resources')
                                  PsiElement(SentinelTokenType.[)('[')
                                  PsiElement(SentinelTokenType.IDENTIFIER)('address')
                                  PsiElement(SentinelTokenType.])(']')
                                PsiWhiteSpace(' ')
                                PsiElement(SentinelTokenType.=)('=')
                                PsiWhiteSpace(' ')
                                SentinelBooleanExpressionsImpl(BOOLEAN_EXPRESSIONS)
                                  SentinelBooleanExpressionImpl(BOOLEAN_EXPRESSION)
                                    SentinelBooleanExpressionSegmentImpl(BOOLEAN_EXPRESSION_SEGMENT)
                                      SentinelChainedIdentifierImpl(CHAINED_IDENTIFIER)
                                        PsiElement(SentinelTokenType.IDENTIFIER)('r')
                            PsiWhiteSpace('\n      ')
                            PsiElement(SentinelTokenType.})('}')
                      PsiWhiteSpace('\n    ')
                      PsiElement(SentinelTokenType.})('}')
                PsiWhiteSpace('\n  ')
                PsiElement(SentinelTokenType.})('}')
          PsiWhiteSpace('\n\n  ')
          SentinelReturnStatementImpl(RETURN_STATEMENT)
            PsiElement(SentinelTokenType.return)('return')
            PsiWhiteSpace(' ')
            PsiElement(SentinelTokenType.IDENTIFIER)('resources')
          PsiWhiteSpace('\n')
          PsiElement(SentinelTokenType.})('}')
  PsiWhiteSpace('\n\n')
  PsiComment(SentinelTokenType.COMMENT)('# Validate that all instances of specified type have a specified top-level')
  PsiWhiteSpace('\n')
  PsiComment(SentinelTokenType.COMMENT)('# attribute that contains all members of a given list')
  PsiWhiteSpace('\n')
  PsiElement(SentinelTokenType.IDENTIFIER)('validate_attribute_contains_list')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.=)('=')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.func)('func')
  PsiElement(SentinelTokenType.()('(')
  PsiElement(SentinelTokenType.IDENTIFIER)('type')
  PsiElement(SentinelTokenType.,)(',')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.IDENTIFIER)('attribute')
  PsiElement(SentinelTokenType.,)(',')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.IDENTIFIER)('required_values')
  PsiElement(SentinelTokenType.))(')')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.{)('{')
  PsiWhiteSpace('\n\n  ')
  PsiElement(SentinelTokenType.IDENTIFIER)('validated')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.=)('=')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.true)('true')
  PsiWhiteSpace('\n\n  ')
  PsiComment(SentinelTokenType.COMMENT)('# Get all resource instances of the specified type')
  PsiWhiteSpace('\n  ')
  PsiElement(SentinelTokenType.IDENTIFIER)('resource_instances')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.=)('=')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.IDENTIFIER)('find_resources_from_plan')
  PsiElement(SentinelTokenType.()('(')
  PsiElement(SentinelTokenType.IDENTIFIER)('type')
  PsiElement(SentinelTokenType.))(')')
  PsiWhiteSpace('\n\n  ')
  PsiComment(SentinelTokenType.COMMENT)('# Loop through the resource instances')
  PsiWhiteSpace('\n  ')
  PsiElement(SentinelTokenType.for)('for')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.IDENTIFIER)('resource_instances')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.as)('as')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.IDENTIFIER)('address')
  PsiElement(SentinelTokenType.,)(',')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.IDENTIFIER)('r')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.{)('{')
  PsiWhiteSpace('\n\n    ')
  PsiComment(SentinelTokenType.COMMENT)('# Skip resource instances that are being destroyed')
  PsiWhiteSpace('\n    ')
  PsiComment(SentinelTokenType.COMMENT)('# to avoid unnecessary policy violations.')
  PsiWhiteSpace('\n    ')
  PsiComment(SentinelTokenType.COMMENT)('# Used to be: if length(r.diff) == 0')
  PsiWhiteSpace('\n    ')
  PsiElement(SentinelTokenType.if)('if')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.IDENTIFIER)('r')
  PsiElement(SentinelTokenType..)('.')
  PsiElement(SentinelTokenType.IDENTIFIER)('destroy')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.and)('and')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.not)('not')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.IDENTIFIER)('r')
  PsiElement(SentinelTokenType..)('.')
  PsiElement(SentinelTokenType.IDENTIFIER)('requires_new')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.{)('{')
  PsiWhiteSpace('\n      ')
  PsiElement(SentinelTokenType.IDENTIFIER)('print')
  PsiElement(SentinelTokenType.()('(')
  PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"Skipping resource"')
  PsiElement(SentinelTokenType.,)(',')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.IDENTIFIER)('address')
  PsiElement(SentinelTokenType.,)(',')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"that is being destroyed."')
  PsiElement(SentinelTokenType.))(')')
  PsiWhiteSpace('\n      ')
  PsiErrorElement:SentinelTokenType.else or SentinelTokenType.} expected, got 'continue'
    PsiElement(SentinelTokenType.continue)('continue')
  PsiElement(DUMMY_BLOCK)
    PsiElement(DUMMY_BLOCK)
      PsiWhiteSpace('\n    ')
      PsiElement(SentinelTokenType.})('}')
      PsiWhiteSpace('\n\n    ')
      PsiComment(SentinelTokenType.COMMENT)('# Determine if the attribute is computed')
      PsiWhiteSpace('\n    ')
      PsiComment(SentinelTokenType.COMMENT)('# We check "attribute.%" and "attribute.#" because an')
      PsiWhiteSpace('\n    ')
      PsiComment(SentinelTokenType.COMMENT)('# attribute of type map or list won't show up in the diff')
      PsiWhiteSpace('\n    ')
      PsiElement(SentinelTokenType.if)('if')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.()('(')
      PsiElement(SentinelTokenType.IDENTIFIER)('r')
      PsiElement(SentinelTokenType..)('.')
      PsiElement(SentinelTokenType.IDENTIFIER)('diff')
      PsiElement(SentinelTokenType.[)('[')
      PsiElement(SentinelTokenType.IDENTIFIER)('attribute')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.+)('+')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('".%"')
    PsiElement(DUMMY_BLOCK)
      PsiElement(SentinelTokenType.])(']')
      PsiElement(SentinelTokenType..)('.')
      PsiElement(SentinelTokenType.IDENTIFIER)('computed')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.else)('else')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.false)('false')
      PsiElement(SentinelTokenType.))(')')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.or)('or')
      PsiWhiteSpace('\n       ')
      PsiElement(SentinelTokenType.()('(')
      PsiElement(SentinelTokenType.IDENTIFIER)('r')
      PsiElement(SentinelTokenType..)('.')
    PsiElement(DUMMY_BLOCK)
      PsiElement(SentinelTokenType.IDENTIFIER)('diff')
      PsiElement(SentinelTokenType.[)('[')
      PsiElement(SentinelTokenType.IDENTIFIER)('attribute')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.+)('+')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('".#"')
      PsiElement(SentinelTokenType.])(']')
      PsiElement(SentinelTokenType..)('.')
      PsiElement(SentinelTokenType.IDENTIFIER)('computed')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.else)('else')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.false)('false')
    PsiElement(DUMMY_BLOCK)
      PsiElement(SentinelTokenType.))(')')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.{)('{')
      PsiWhiteSpace('\n      ')
      PsiElement(SentinelTokenType.IDENTIFIER)('print')
      PsiElement(SentinelTokenType.()('(')
      PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"Resource"')
      PsiElement(SentinelTokenType.,)(',')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.IDENTIFIER)('address')
      PsiElement(SentinelTokenType.,)(',')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"has attribute"')
      PsiElement(SentinelTokenType.,)(',')
    PsiElement(DUMMY_BLOCK)
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.IDENTIFIER)('attribute')
      PsiElement(SentinelTokenType.,)(',')
      PsiWhiteSpace('\n            ')
      PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"that is computed."')
      PsiElement(SentinelTokenType.))(')')
      PsiWhiteSpace('\n      ')
      PsiComment(SentinelTokenType.COMMENT)('# If you want computed values to cause the policy to fail,')
      PsiWhiteSpace('\n      ')
      PsiComment(SentinelTokenType.COMMENT)('# uncomment the next line.')
      PsiWhiteSpace('\n      ')
      PsiComment(SentinelTokenType.COMMENT)('# validated = false')
      PsiWhiteSpace('\n    ')
      PsiElement(SentinelTokenType.})('}')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.else)('else')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.{)('{')
      PsiWhiteSpace('\n      ')
      PsiComment(SentinelTokenType.COMMENT)('# Validate that the attribute is a list or a map')
      PsiWhiteSpace('\n      ')
      PsiComment(SentinelTokenType.COMMENT)('# but first check if r.applied[attribute] exists')
      PsiWhiteSpace('\n      ')
      PsiElement(SentinelTokenType.if)('if')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.IDENTIFIER)('r')
      PsiElement(SentinelTokenType..)('.')
    PsiElement(DUMMY_BLOCK)
      PsiElement(SentinelTokenType.IDENTIFIER)('applied')
      PsiElement(SentinelTokenType.[)('[')
      PsiElement(SentinelTokenType.IDENTIFIER)('attribute')
      PsiElement(SentinelTokenType.])(']')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.else)('else')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.null)('null')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.is)('is')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.not)('not')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.null)('null')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.and)('and')
    PsiElement(DUMMY_BLOCK)
      PsiWhiteSpace('\n         ')
      PsiElement(SentinelTokenType.()('(')
      PsiElement(SentinelTokenType.IDENTIFIER)('types')
      PsiElement(SentinelTokenType..)('.')
      PsiElement(SentinelTokenType.IDENTIFIER)('type_of')
      PsiElement(SentinelTokenType.()('(')
      PsiElement(SentinelTokenType.IDENTIFIER)('r')
      PsiElement(SentinelTokenType..)('.')
      PsiElement(SentinelTokenType.IDENTIFIER)('applied')
      PsiElement(SentinelTokenType.[)('[')
      PsiElement(SentinelTokenType.IDENTIFIER)('attribute')
    PsiElement(DUMMY_BLOCK)
      PsiElement(SentinelTokenType.])(']')
      PsiElement(SentinelTokenType.))(')')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.is)('is')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"list"')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.or)('or')
      PsiWhiteSpace('\n          ')
      PsiElement(SentinelTokenType.IDENTIFIER)('types')
      PsiElement(SentinelTokenType..)('.')
      PsiElement(SentinelTokenType.IDENTIFIER)('type_of')
      PsiElement(SentinelTokenType.()('(')
      PsiElement(SentinelTokenType.IDENTIFIER)('r')
    PsiElement(DUMMY_BLOCK)
      PsiElement(SentinelTokenType..)('.')
      PsiElement(SentinelTokenType.IDENTIFIER)('applied')
      PsiElement(SentinelTokenType.[)('[')
      PsiElement(SentinelTokenType.IDENTIFIER)('attribute')
      PsiElement(SentinelTokenType.])(']')
      PsiElement(SentinelTokenType.))(')')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.is)('is')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"map"')
      PsiElement(SentinelTokenType.))(')')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.{)('{')
    PsiElement(DUMMY_BLOCK)
      PsiWhiteSpace('\n\n        ')
      PsiComment(SentinelTokenType.COMMENT)('# Evaluate each member of required_values list')
      PsiWhiteSpace('\n        ')
      PsiElement(SentinelTokenType.for)('for')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.IDENTIFIER)('required_values')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.as)('as')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.IDENTIFIER)('rv')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.{)('{')
      PsiWhiteSpace('\n          ')
      PsiElement(SentinelTokenType.if)('if')
      PsiWhiteSpace(' ')
      PsiElement(SentinelTokenType.IDENTIFIER)('r')
      PsiElement(SentinelTokenType..)('.')
      PsiElement(SentinelTokenType.IDENTIFIER)('applied')
      PsiElement(SentinelTokenType.[)('[')
  PsiElement(DUMMY_BLOCK)
    PsiElement(SentinelTokenType.IDENTIFIER)('attribute')
    PsiElement(SentinelTokenType.])(']')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.not)('not')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.contains)('contains')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.IDENTIFIER)('rv')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.{)('{')
    PsiWhiteSpace('\n            ')
    PsiElement(SentinelTokenType.IDENTIFIER)('print')
    PsiElement(SentinelTokenType.()('(')
    PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"Resource"')
    PsiElement(SentinelTokenType.,)(',')
  PsiElement(DUMMY_BLOCK)
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.IDENTIFIER)('address')
    PsiElement(SentinelTokenType.,)(',')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"has attribute"')
    PsiElement(SentinelTokenType.,)(',')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.IDENTIFIER)('attribute')
    PsiElement(SentinelTokenType.,)(',')
    PsiWhiteSpace('\n                  ')
    PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"that is missing required value"')
    PsiElement(SentinelTokenType.,)(',')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.IDENTIFIER)('rv')
    PsiElement(SentinelTokenType.,)(',')
  PsiElement(DUMMY_BLOCK)
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"from the list:"')
    PsiElement(SentinelTokenType.,)(',')
    PsiWhiteSpace('\n                  ')
    PsiElement(SentinelTokenType.IDENTIFIER)('required_values')
    PsiElement(SentinelTokenType.))(')')
    PsiWhiteSpace('\n            ')
    PsiElement(SentinelTokenType.IDENTIFIER)('validated')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.=)('=')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.false)('false')
    PsiWhiteSpace('\n          ')
    PsiElement(SentinelTokenType.})('}')
    PsiWhiteSpace(' ')
    PsiComment(SentinelTokenType.COMMENT)('// end rv')
    PsiWhiteSpace('\n        ')
    PsiElement(SentinelTokenType.})('}')
    PsiWhiteSpace(' ')
    PsiComment(SentinelTokenType.COMMENT)('// end required_values')
    PsiWhiteSpace('\n\n      ')
    PsiElement(SentinelTokenType.})('}')
  PsiElement(DUMMY_BLOCK)
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.else)('else')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.{)('{')
    PsiWhiteSpace('\n        ')
    PsiElement(SentinelTokenType.IDENTIFIER)('print')
    PsiElement(SentinelTokenType.()('(')
    PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"Resource"')
    PsiElement(SentinelTokenType.,)(',')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.IDENTIFIER)('address')
    PsiElement(SentinelTokenType.,)(',')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"is missing attribute"')
    PsiElement(SentinelTokenType.,)(',')
  PsiElement(DUMMY_BLOCK)
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.IDENTIFIER)('attribute')
    PsiElement(SentinelTokenType.,)(',')
    PsiWhiteSpace('\n              ')
    PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"or it is not a list or a map"')
    PsiElement(SentinelTokenType.))(')')
    PsiWhiteSpace('\n        ')
    PsiElement(SentinelTokenType.IDENTIFIER)('validated')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.=)('=')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.false)('false')
    PsiWhiteSpace('\n      ')
    PsiElement(SentinelTokenType.})('}')
    PsiWhiteSpace(' ')
    PsiComment(SentinelTokenType.COMMENT)('// end check that attribute is list or map')
    PsiWhiteSpace('\n\n    ')
    PsiElement(SentinelTokenType.})('}')
    PsiWhiteSpace(' ')
    PsiComment(SentinelTokenType.COMMENT)('// end computed check')
    PsiWhiteSpace('\n  ')
    PsiElement(SentinelTokenType.})('}')
  PsiElement(DUMMY_BLOCK)
    PsiWhiteSpace(' ')
    PsiComment(SentinelTokenType.COMMENT)('// end resource instances')
    PsiWhiteSpace('\n\n  ')
    PsiElement(SentinelTokenType.return)('return')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.IDENTIFIER)('validated')
    PsiWhiteSpace('\n')
    PsiElement(SentinelTokenType.})('}')
    PsiWhiteSpace('\n\n')
    PsiComment(SentinelTokenType.COMMENT)('### List of mandatory tags ###')
    PsiWhiteSpace('\n')
    PsiElement(SentinelTokenType.IDENTIFIER)('mandatory_tags')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.=)('=')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.[)('[')
    PsiWhiteSpace('\n  ')
    PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"Name"')
    PsiElement(SentinelTokenType.,)(',')
    PsiWhiteSpace('\n  ')
    PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"ttl"')
    PsiElement(SentinelTokenType.,)(',')
  PsiElement(DUMMY_BLOCK)
    PsiWhiteSpace('\n  ')
    PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"owner"')
    PsiElement(SentinelTokenType.,)(',')
    PsiWhiteSpace('\n')
    PsiElement(SentinelTokenType.])(']')
    PsiWhiteSpace('\n\n')
    PsiComment(SentinelTokenType.COMMENT)('### Rules ###')
    PsiWhiteSpace('\n\n')
    PsiComment(SentinelTokenType.COMMENT)('# Call the validation function')
    PsiWhiteSpace('\n')
    PsiElement(SentinelTokenType.IDENTIFIER)('tags_validated')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.=)('=')
    PsiWhiteSpace(' ')
    PsiElement(SentinelTokenType.IDENTIFIER)('validate_attribute_contains_list')
    PsiElement(SentinelTokenType.()('(')
    PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"aws_instance"')
    PsiElement(SentinelTokenType.,)(',')
    PsiWhiteSpace('\n                 ')
    PsiElement(SentinelTokenType.DOUBLE_QUOTED_STRING)('"tags"')
  PsiElement(SentinelTokenType.,)(',')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.IDENTIFIER)('mandatory_tags')
  PsiElement(SentinelTokenType.))(')')
  PsiWhiteSpace('\n\n')
  PsiComment(SentinelTokenType.COMMENT)('#Main rule')
  PsiWhiteSpace('\n')
  PsiElement(SentinelTokenType.main)('main')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.=)('=')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.rule)('rule')
  PsiWhiteSpace(' ')
  PsiElement(SentinelTokenType.{)('{')
  PsiWhiteSpace('\n  ')
  PsiElement(SentinelTokenType.IDENTIFIER)('tags_validated')
  PsiWhiteSpace('\n')
  PsiElement(SentinelTokenType.})('}')